/************************************************************************************************/
/** 
 * @file		KsMD5.h
 * @brief		MD5
 * @author		Tsukasa Kato
 * @date		2005/10/17
 * @since		2005/10/17
 * @version		1.0.0
 */
/************************************************************************************************/
#ifndef __KSMD5_H__
#define __KSMD5_H__

/*==============================================================================================*/
/*                                 << インクルード >>                                           */
/*==============================================================================================*/

/*==============================================================================================*/
/*                                     << 宣言 >>                                               */
/*==============================================================================================*/

/*==============================================================================================*/
/*                                     << 定義 >>                                               */
/*==============================================================================================*/

/************************************************************************************************/
/**
 * @struct		KsMD5.h
 * @brief		MD5用コンテキスト
 * @author		Tsukasa Kato
 * @date		2005/10/17
 * @since		2005/10/17
 * @version		1.0.0
 * @note		なし
 */
/************************************************************************************************/
typedef struct _KsMD5Context
{
	KsUInt32			buf[ 4 ];
	KsUInt32			bits[ 2 ];
	KsUInt8			in[ 64 ];

}KsMD5Context;

/************************************************************************************************/
/**
 * MD5コンテキストの初期化
 * @param		pContext		コンテキスト
 */
/************************************************************************************************/
ksENGINE_API void KsMD5Init( KsMD5Context* pContext );

/************************************************************************************************/
/**
 * MD5コンテキストの更新処理
 * @param		pContext		コンテキスト
 * @param		buf				バッファ
 * @param		len				バッファサイズ
 */
/************************************************************************************************/
ksENGINE_API void KsMD5Update( KsMD5Context* pContext, const KsUInt8 *buf, KsUInt32 len );

/************************************************************************************************/
/**
 * MD5終了処理
 * @param		pContext		コンテキスト
 */
/************************************************************************************************/
ksENGINE_API void KsMD5Final( KsUInt8 digest[16], KsMD5Context* pContext );

/************************************************************************************************/
/**
 * MD5コンテキストの初期化
 * @param		pContext		コンテキスト
 */
/************************************************************************************************/
ksENGINE_API void KsMD5Transform( KsUInt32 buf[4], KsUInt32 in[16] );

/************************************************************************************************/
/**
 * MD5コンテキストの初期化
 * @param		pContext		コンテキスト
 */
/************************************************************************************************/
ksENGINE_API KsInt8* KsCryptMD5( const KsInt8* pw, const KsInt8* salt );

#endif /* __KSMD5_H__ */

