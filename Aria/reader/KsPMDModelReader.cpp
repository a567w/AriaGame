/************************************************************************************************/
/** 
 * @file		KsPMDModelReader.cpp
 * @brief		PMD Model Reader
 * @author		Tsukasa Kato
 * @date		2011/07/02
 * @since		2011/07/02
 * @version		1.0.0
 */
/************************************************************************************************/

/*==============================================================================================*/
/*                                 << ワーニング抑制 >>                                          */
/*==============================================================================================*/

/*==============================================================================================*/
/*                                 << インクルード >>                                            */
/*==============================================================================================*/
#include "KsGamePreCompile.h"
#include "KsPMDModelReader.h"

/*==============================================================================================*/
/*                                     << 宣言 >>                                               */
/*==============================================================================================*/

/*==============================================================================================*/
/*                                     << 定義 >>                                               */
/*==============================================================================================*/

/************************************************************************************************/
/*
 * コンストラクタ
 * 同期読み込み(読み込みが終了するまで待つ)
 * @param		fileName		ファイル名
 */
/************************************************************************************************/
KsPMDModelReader::KsPMDModelReader( const KsString& fileName )
	: KsFileAsyncReader( fileName )
	, m_pModel( 0 )
{
}

/************************************************************************************************/
/*
 * デストラクタ
 */
/************************************************************************************************/
KsPMDModelReader::~KsPMDModelReader()
{
}

/************************************************************************************************/
/**
* 読み込み終了時のコールバック関数
* @param		pFile			ファイルオブジェクト
*/
/************************************************************************************************/
KsBool KsPMDModelReader::readEndThreadCB( KsFileObject* pFile )
{
	m_pModel = KsModelCreateFromKMD( pFile );

	//KS_PMD_DATA*	pPMD   = KsLoadPMDFile( pFile );
	
	//m_pModel = KsModelCreateFromPMD( pPMD );

	return ksTRUE;
}

/************************************************************************************************/
/**
* 読み込み終了時のコールバック関数
* @param		pFile			ファイルオブジェクト
*/
/************************************************************************************************/
KsBool KsPMDModelReader::readEndCB( KsFileObject* pFile )
{
	KsGameSystem*	pSystem = KsGameSystem::getInstancePtr();

	pSystem->addModel( m_pModel );

	return ksTRUE;
}


